# Description : libmpack lua bindings
# URL         : https://github.com/libmpack/libmpack-lua
# Maintainer  : marin, https://github.com/turquoise-hexagon/ports/issues
# Depends on  : lua lua51

name=libmpack-lua
version=1.0.7
release=1
source=("https://github.com/${name%-*}/$name/archive/$version.tar.gz")

build() {
    cd "$name-$version"

    make
    make -C mpack-src

    for version in 5.{1..3}; do
        gcc -O2 -fPIC "-I/usr/include/lua$version" -c lmpack.c -o lmpack.o
        gcc -shared -o "mpack.so.$version" lmpack.o
        install -Dm755 "mpack.so.$version" "$PKG/usr/lib/lua/$version/mpack.so"
    done
}

# vim: ft=sh
